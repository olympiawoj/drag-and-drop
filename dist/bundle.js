(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&e.value.toString().trim().length>0),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const l=i.getInstance();class o extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler.bind(this))}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:+r,required:!0,min:0,max:5};return t({value:e,required:!0})&&t(s)&&t(i)?[e,n,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;console.log(e,n,r),l.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],o.prototype,"submitHandler",null);class a extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"dragStartHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){if(e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]){e.preventDefault();const t=this.element.querySelector("ul");null==t||t.classList.add("droppable")}}dropHandler(e){e.preventDefault();const t=e.dataTransfer.getData("text/plain");l.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){const t=this.element.querySelector("ul");null==t||t.classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),l.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+"PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}}c([n],d.prototype,"dragOverHandler",null),c([n],d.prototype,"dropHandler",null),c([n],d.prototype,"dragLeaveHandler",null),new o,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2FwcC50cyJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwidmFsaWRhdGUiLCJ2YWxpZGF0YWJsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidmFsdWUiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJhdXRvYmluZCIsIl8iLCJfMiIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbE1ldGhvZCIsImNvbmZpZ3VyYWJsZSIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJQcm9qZWN0U3RhdGUiLCJsaXN0ZW5lcnMiLCJsaXN0ZW5lckZuIiwicHVzaCIsInN1cGVyIiwicHJvamVjdHMiLCJpbnN0YW5jZSIsIm51bW9mUGVvcGxlIiwibmV3UHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmluZCIsInByaiIsInNsaWNlIiwicHJvamVjdFN0YXRlIiwiZ2V0SW5zdGFuY2UiLCJQcm9qZWN0SW5wdXQiLCJ0aXRsZUlucHV0RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0RWxlbWVudCIsInBlb3BsZUlucHV0RWxlbWVudCIsImNvbmZpZ3VyZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJJbnB1dCIsImdhdGhlclVzZXJJbnB1dCIsIkFycmF5IiwiaXNBcnJheSIsImRlc2MiLCJjb25zb2xlIiwibG9nIiwiYWRkUHJvamVjdCIsImNsZWFySW5wdXRzIiwiUHJvamVjdEl0ZW0iLCJob3N0SWQiLCJyZW5kZXJDb250ZW50IiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZHJhZ0VuZEhhbmRsZXIiLCJ0ZXh0Q29udGVudCIsInBlcnNvbnMiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwidHlwZXMiLCJsaXN0RWwiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmpJZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsIkZpbmlzaGVkIiwicmVtb3ZlIiwiZHJhZ092ZXJIYW5kbGVyIiwiZHJhZ0xlYXZlSGFuZGxlciIsImRyb3BIYW5kbGVyIiwiYWRkTGlzdGVuZXIiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iXSwibWFwcGluZ3MiOiJtQkFDZSxNQUFlQSxFQUkxQixZQUNFQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBQyxLQUFLQyxnQkFBa0JDLFNBQVNDLGVBQzlCUCxHQUVGSSxLQUFLSSxZQUFjRixTQUFTQyxlQUFlTixHQUUzQyxNQUFNUSxFQUFlSCxTQUFTSSxXQUM1Qk4sS0FBS0MsZ0JBQWdCTSxTQUNyQixHQUVGUCxLQUFLUSxRQUFVSCxFQUFhSSxrQkFDeEJWLElBQ0ZDLEtBQUtRLFFBQVFFLEdBQUtYLEdBRXBCQyxLQUFLVyxPQUFPYixHQUVOLE9BQU9jLEdBQ2JaLEtBQUtJLFlBQVlTLHNCQUNmRCxFQUFvQixhQUFlLFlBQ25DWixLQUFLUSxVQ2xCSixTQUFTTSxFQUFTQyxHQUN2QixJQUFJQyxHQUFVLEVBK0JkLE9BOUJJRCxFQUFpQkUsV0FDbkJELEVBQVVBLEdBQVdELEVBQWlCRyxNQUFNQyxXQUFXQyxPQUFPQyxPQUFTLEdBR3pDLE1BQTlCTixFQUFpQk8sV0FDaUIsaUJBQTNCUCxFQUFpQkcsUUFFeEJGLEVBQ0VBLEdBQVdELEVBQWlCRyxNQUFNRyxPQUFTTixFQUFpQk8sV0FHaEMsTUFBOUJQLEVBQWlCUSxXQUNpQixpQkFBM0JSLEVBQWlCRyxRQUV4QkYsRUFDRUEsR0FBV0QsRUFBaUJHLE1BQU1HLE9BQVNOLEVBQWlCUSxXQUd0QyxNQUF4QlIsRUFBaUJTLEtBQ2lCLGlCQUEzQlQsRUFBaUJHLFFBRXhCRixFQUFVQSxHQUFXRCxFQUFpQkcsTUFBUUgsRUFBaUJTLEtBR3ZDLE1BQXhCVCxFQUFpQlUsS0FDaUIsaUJBQTNCVixFQUFpQkcsUUFFeEJGLEVBQVVBLEdBQVdELEVBQWlCRyxNQUFRSCxFQUFpQlUsS0FHMURULEVDMUNKLFNBQVNVLEVBQVNDLEVBQVFDLEVBQVlDLEdBQ3pDLE1BQU1DLEVBQWlCRCxFQUFXWCxNQVFsQyxNQVAwQyxDQUN4Q2EsY0FBYyxFQUNkLE1BRUUsT0FEZ0JELEVBQWVFLEtBQUtoQyxRQ0w1QyxJQUFZaUMsR0FBWixTQUFZQSxHQUNKLHVCQUNBLDJCQUZSLENBQVlBLE1BQWEsS0FLbEIsTUFBTUMsRUFDTCxZQUNXeEIsRUFDQXlCLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBSkEsS0FBQTVCLEtBQ0EsS0FBQXlCLFFBQ0EsS0FBQUMsY0FDQSxLQUFBQyxTQUNBLEtBQUFDLFVDQVosTUFBTUMsVUFQYixvQkFDWSxLQUFBQyxVQUEyQixHQUNyQyxZQUFZQyxHQUNWekMsS0FBS3dDLFVBQVVFLEtBQUtELEtBUXRCLGNBQ0VFLFFBSk0sS0FBQUMsU0FBc0IsR0FPOUIscUJBQ0UsT0FBSTVDLEtBQUs2QyxXQUdUN0MsS0FBSzZDLFNBQVcsSUFBSU4sR0FGWHZDLEtBQUs2QyxTQUtoQixXQUFXVixFQUFlQyxFQUFxQlUsR0FDN0MsTUFBTUMsRUFBYSxJQUFJYixFQUNyQmMsS0FBS0MsU0FBUzlCLFdBQ2RnQixFQUNBQyxFQUNBVSxFQUNBYixFQUFjaUIsUUFTaEJsRCxLQUFLNEMsU0FBU0YsS0FBS0ssR0FDbkIvQyxLQUFLbUQsa0JBSVAsWUFBWUMsRUFBbUJDLEdBQzdCLE1BQU1DLEVBQVV0RCxLQUFLNEMsU0FBU1csTUFBS0MsR0FBT0EsRUFBSTlDLEtBQU8wQyxJQUNsREUsR0FBV0EsRUFBUWhCLFNBQVdlLElBQy9CQyxFQUFRaEIsT0FBU2UsRUFDakJyRCxLQUFLbUQsbUJBSUQsa0JBQ04sSUFBSyxNQUFNVixLQUFjekMsS0FBS3dDLFVBQzVCQyxFQUFXekMsS0FBSzRDLFNBQVNhLFVBTXhCLE1BQU1DLEVBQWVuQixFQUFhb0IsY0N6RGxDLE1BQU1DLFVBQXFCLEVBSzlCLGNBQ0VqQixNQUFNLGdCQUFpQixPQUFPLEVBQU0sY0FDcEMzQyxLQUFLNkQsa0JBQW9CN0QsS0FBS1EsUUFBUXNELGNBQ3BDLFVBRUY5RCxLQUFLK0Qsd0JBQTBCL0QsS0FBS1EsUUFBUXNELGNBQzFDLGdCQUVGOUQsS0FBS2dFLG1CQUFxQmhFLEtBQUtRLFFBQVFzRCxjQUNyQyxXQUdGOUQsS0FBS2lFLFlBR1AsWUFDRWpFLEtBQUtRLFFBQVEwRCxpQkFBaUIsU0FBVWxFLEtBQUttRSxjQUFjbkMsS0FBS2hDLE9BR2xFLGlCQUVRLGtCQUNOLE1BQU1vRSxFQUFlcEUsS0FBSzZELGtCQUFrQjNDLE1BQ3RDbUQsRUFBcUJyRSxLQUFLK0Qsd0JBQXdCN0MsTUFDbERvRCxFQUFnQnRFLEtBQUtnRSxtQkFBbUI5QyxNQU14Q3FELEVBQWlELENBQ3JEckQsTUFBT21ELEVBQ1BwRCxVQUFVLEVBQ1ZLLFVBQVcsR0FFUGtELEVBQTRDLENBQ2hEdEQsT0FBUW9ELEVBQ1JyRCxVQUFVLEVBQ1ZPLElBQUssRUFDTEMsSUFBSyxHQUdQLE9BQ0csRUFqQjhDLENBQy9DUCxNQUFPa0QsRUFDUG5ELFVBQVUsS0FnQlQsRUFBb0JzRCxJQUNwQixFQUFvQkMsR0FLZCxDQUFDSixFQUFjQyxHQUFxQkMsUUFIM0NHLE1BQU0sb0NBT0YsY0FDTnpFLEtBQUs2RCxrQkFBa0IzQyxNQUFRLEdBQy9CbEIsS0FBSytELHdCQUF3QjdDLE1BQVEsR0FDckNsQixLQUFLZ0UsbUJBQW1COUMsTUFBUSxHQUkxQixjQUFjd0QsR0FDcEJBLEVBQU1DLGlCQUVOLE1BQU1DLEVBQVk1RSxLQUFLNkUsa0JBQ3ZCLEdBQUlDLE1BQU1DLFFBQVFILEdBQVksQ0FDNUIsTUFBT3pDLEVBQU82QyxFQUFNM0MsR0FBVXVDLEVBQzlCSyxRQUFRQyxJQUFJL0MsRUFBTzZDLEVBQU0zQyxHQUN6QnFCLEVBQWF5QixXQUFXaEQsRUFBTzZDLEVBQU0zQyxHQUNyQ3JDLEtBQUtvRixpQiwwVEFSVCxFQURDLEcsa0NDakVFLE1BQU1DLFVBQ0QxRixFQVdSLFlBQVkyRixFQUFnQmhDLEdBQ3hCWCxNQUFNLGlCQUFrQjJDLEdBQVEsRUFBT2hDLEVBQVE1QyxJQUMvQ1YsS0FBS3NELFFBQVVBLEVBRWZ0RCxLQUFLaUUsWUFDTGpFLEtBQUt1RixnQkFaVCxjQUNJLE9BQTRCLElBQXhCdkYsS0FBS3NELFFBQVFqQixPQUNOLFdBRUksR0FBR3JDLEtBQUtzRCxRQUFRakIsaUJBV25DLGlCQUFpQnFDLEdBQ2JBLEVBQU1jLGFBQWNDLFFBQVEsYUFBY3pGLEtBQUtzRCxRQUFRNUMsSUFDdkRnRSxFQUFNYyxhQUFjRSxjQUFnQixPQUV4QyxlQUFlL0QsR0FDWHNELFFBQVFDLElBQUksV0FHaEIsWUFDSWxGLEtBQUtRLFFBQVEwRCxpQkFBaUIsWUFBYWxFLEtBQUsyRixrQkFDaEQzRixLQUFLUSxRQUFRMEQsaUJBQWlCLFVBQVdsRSxLQUFLNEYsZ0JBRWxELGdCQUNJNUYsS0FBS1EsUUFBUXNELGNBQWMsTUFBTytCLFlBQWM3RixLQUFLc0QsUUFBUW5CLE1BQzdEbkMsS0FBS1EsUUFBUXNELGNBQWMsTUFBTytCLFlBQWM3RixLQUFLOEYsUUFBVSxZQUMvRDlGLEtBQUtRLFFBQVFzRCxjQUFjLEtBQU0rQixZQUFjN0YsS0FBS3NELFFBQVFsQixjLDBUQWZoRSxFQURDVixHLCtXQ2hCRSxNQUFNcUUsVUFDSHBHLEVBR1IsWUFBb0JxRyxHQUNsQnJELE1BQU0sZUFBZ0IsT0FBTyxFQUFPLEdBQUdxRCxjQURyQixLQUFBQSxPQUdsQmhHLEtBQUtpRyxpQkFBbUIsR0FFeEJqRyxLQUFLaUUsWUFDTGpFLEtBQUt1RixnQkFJUCxnQkFBZ0JiLEdBQ2QsR0FBR0EsRUFBTWMsY0FBZ0QsZUFBaENkLEVBQU1jLGFBQWFVLE1BQU0sR0FBb0IsQ0FDcEV4QixFQUFNQyxpQkFDTixNQUFNd0IsRUFBU25HLEtBQUtRLFFBQVFzRCxjQUFjLE1BQzFDcUMsV0FBUUMsVUFBVUMsSUFBSSxjQUsxQixZQUFZM0IsR0FDVkEsRUFBTUMsaUJBQ04sTUFBTTJCLEVBQVE1QixFQUFNYyxhQUFjZSxRQUFRLGNBQzFDN0MsRUFBYThDLFlBQVlGLEVBQXFCLFdBQWR0RyxLQUFLZ0csS0FBb0IvRCxFQUFjaUIsT0FBU2pCLEVBQWN3RSxVQUloRyxpQkFBaUI5RSxHQUNmLE1BQU13RSxFQUFTbkcsS0FBS1EsUUFBUXNELGNBQWMsTUFDMUNxQyxXQUFRQyxVQUFVTSxPQUFPLGFBRzNCLFlBQ0UxRyxLQUFLUSxRQUFRMEQsaUJBQWlCLFdBQVlsRSxLQUFLMkcsaUJBQy9DM0csS0FBS1EsUUFBUTBELGlCQUFpQixZQUFhbEUsS0FBSzRHLGtCQUNoRDVHLEtBQUtRLFFBQVEwRCxpQkFBaUIsT0FBUWxFLEtBQUs2RyxhQUMzQ25ELEVBQWFvRCxhQUFhbEUsSUFDeEIsTUFBTW1FLEVBQW1CbkUsRUFBU29FLFFBQVF4RCxHQUN0QixXQUFkeEQsS0FBS2dHLEtBQ0F4QyxFQUFJbEIsU0FBV0wsRUFBY2lCLE9BRS9CTSxFQUFJbEIsU0FBV0wsRUFBY3dFLFdBR3RDekcsS0FBS2lHLGlCQUFtQmMsRUFDeEIvRyxLQUFLaUgsb0JBR1QsZ0JBQ0UsTUFBTUMsRUFBUyxHQUFHbEgsS0FBS2dHLHFCQUN2QmhHLEtBQUtRLFFBQVFzRCxjQUFjLE1BQU9wRCxHQUFLd0csRUFDdkNsSCxLQUFLUSxRQUFRc0QsY0FBYyxNQUFPK0IsWUFDaEM3RixLQUFLZ0csS0FBS21CLGNBQWdCLFdBR3RCLGlCQUNTakgsU0FBU0MsZUFBZSxHQUFHSCxLQUFLZ0csc0JBQ3hDb0IsVUFBWSxHQUNuQixJQUFLLE1BQU1DLEtBQVdySCxLQUFLaUcsaUJBSXpCLElBQUlaLEVBQVlyRixLQUFLUSxRQUFRc0QsY0FBYyxNQUFPcEQsR0FBSTJHLElBbkQxRCxHQURDM0YsRyxvQ0FVRCxHQURDQSxHLGdDQVFELEdBRENBLEcscUNDbkNILElBQUlrQyxFQUNKLElBQUltQyxFQUFZLFVBQ2hCLElBQUlBLEVBQVksYSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb21wb25lbnQgQmFzZSBDbGFzc1xuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XG4gICAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xuICAgIGhvc3RFbGVtZW50OiBUO1xuICAgIGVsZW1lbnQ6IFU7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXG4gICAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXG4gICAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxuICAgICAgbmV3RWxlbWVudElkPzogc3RyaW5nXG4gICAgKSB7XG4gICAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFxuICAgICAgICB0ZW1wbGF0ZUlkXG4gICAgICApISBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xuICAgICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuICBcbiAgICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUoXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICAgIGlmIChuZXdFbGVtZW50SWQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkO1xuICAgICAgfVxuICAgICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydCk7XG4gICAgfVxuICAgIHByaXZhdGUgYXR0YWNoKGluc2VydEF0QmVnaW5uaW5nOiBib29sZWFuKSB7XG4gICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChcbiAgICAgICAgaW5zZXJ0QXRCZWdpbm5pbmcgPyBcImFmdGVyYmVnaW5cIiA6IFwiYmVmb3JlZW5kXCIsXG4gICAgICAgIHRoaXMuZWxlbWVudFxuICAgICAgKTtcbiAgICB9XG4gIFxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbiAgfVxuICBcbiIsIlxuLy8gVmFsaWRhdGlvblxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XG4gICAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XG4gICAgbWluTGVuZ3RoPzogbnVtYmVyOyAvLyBjaGVja3MgbGVuIG9mIHN0cmluZ1xuICAgIG1heExlbmd0aD86IG51bWJlcjtcbiAgICBtaW4/OiBudW1iZXI7IC8vIGNoZWNrcyB2YWx1ZSBvZiBudW1cbiAgICBtYXg/OiBudW1iZXI7XG4gIH1cbiAgXG4gIGV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0YWJsZUlucHV0OiBWYWxpZGF0YWJsZSkge1xuICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlZCkge1xuICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmXG4gICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gXCJzdHJpbmdcIlxuICAgICkge1xuICAgICAgaXNWYWxpZCA9XG4gICAgICAgIGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPiB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aDtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJlxuICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwic3RyaW5nXCJcbiAgICApIHtcbiAgICAgIGlzVmFsaWQgPVxuICAgICAgICBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoIDwgdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGg7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiZcbiAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSBcIm51bWJlclwiXG4gICAgKSB7XG4gICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID4gdmFsaWRhdGFibGVJbnB1dC5taW47XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiZcbiAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSBcIm51bWJlclwiXG4gICAgKSB7XG4gICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlIDwgdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gICAgfVxuICBcbiAgICByZXR1cm4gaXNWYWxpZDtcbiAgfVxuIiwiLy8gYXV0b2JpbmQgZGVjb3JhdG9yXG5leHBvcnQgZnVuY3Rpb24gYXV0b2JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpIHtcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgY29uc3QgYWRqRGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0KCkge1xuICAgICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIGJvdW5kRm47XG4gICAgICB9LFxuICAgIH07XG4gICAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XG4gIH1cbiIsIi8vIFByb2plY3QgVHlwZVxuZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XG4gICAgICAgIEFjdGl2ZSxcbiAgICAgICAgRmluaXNoZWQsXG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgICAgICAgY29uc3RydWN0b3IoXG4gICAgICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcbiAgICAgICAgICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxuICAgICAgICAgICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXG4gICAgICAgICAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgICAgICAgICBwdWJsaWMgc3RhdHVzOiBQcm9qZWN0U3RhdHVzXG4gICAgICAgICkgeyB9XG59XG5cbiIsImltcG9ydCB7UHJvamVjdCwgUHJvamVjdFN0YXR1c30gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnXG5cbi8vIFByb2plY3QgU3RhdGUgTWFuYWdlbWVudFxudHlwZSBMaXN0ZW5lcjxUPiA9IChpdGVtczogVFtdKSA9PiB2b2lkO1xuXG5jbGFzcyBTdGF0ZTxUPiB7XG4gIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcbiAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcbiAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XG4gIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gICAgfVxuICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gIH1cbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBudW1vZlBlb3BsZTogbnVtYmVyKSB7XG4gICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KFxuICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxuICAgICAgdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIG51bW9mUGVvcGxlLFxuICAgICAgUHJvamVjdFN0YXR1cy5BY3RpdmVcbiAgICApO1xuICAgIC8vIGNvbnN0IG5ld1Byb2plY3QgPSB7XG4gICAgLy8gICBpZDogTWF0aC5yYW5kb20udG9TdHJpbmcoKSxcbiAgICAvLyAgIHRpdGxlOiB0aXRsZSxcbiAgICAvLyAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAvLyAgIHBlb3BsZTogbnVtb2ZQZW9wbGUsXG4gICAgLy8gfTtcblxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpXG5cbiAgfVxuXG4gIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpe1xuICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocHJqID0+IHByai5pZCA9PT0gcHJvamVjdElkKVxuICAgIGlmKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cyl7XG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpe1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xuICAgICAgbGlzdGVuZXJGbih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xuICAgIH1cbiAgfVxufVxuXG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKTtcblxuIiwiaW1wb3J0IENtcCBmcm9tICcuL2Jhc2UtY29tcG9uZW50J1xuaW1wb3J0ICogYXMgVmFsaWRhdGlvbiBmcm9tICcuLi91dGlsL3ZhbGlkYXRpb24nXG5pbXBvcnQge2F1dG9iaW5kIGFzIEF1dG9iaW5kfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJ1xuaW1wb3J0IHtwcm9qZWN0U3RhdGV9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnXG5cbi8vIFByb2plY3RJbnB1dCBDbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENtcDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XG4gICAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgIHN1cGVyKFwicHJvamVjdC1pbnB1dFwiLCBcImFwcFwiLCB0cnVlLCBcInVzZXItaW5wdXRcIik7XG4gICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIFwiI3RpdGxlXCJcbiAgICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgXCIjZGVzY3JpcHRpb25cIlxuICAgICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgXCIjcGVvcGxlXCJcbiAgICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgXG4gICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIH1cbiAgXG4gICAgY29uZmlndXJlKCkge1xuICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgIH1cbiAgXG4gICAgcmVuZGVyQ29udGVudCgpIHt9XG4gIFxuICAgIHByaXZhdGUgZ2F0aGVyVXNlcklucHV0KCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHVuZGVmaW5lZCB7XG4gICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcbiAgXG4gICAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgICB2YWx1ZTogZW50ZXJlZFRpdGxlLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIH07XG4gICAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgbWluTGVuZ3RoOiA1LFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xuICAgICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsIC8vIHR1cm4gaW50byBhIG51bWJlclxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgbWluOiAwLCAvLyBhdCBsZWFzdCAyIHBlb3BsZSBhc3NpZ25lZFxuICAgICAgICBtYXg6IDUsXG4gICAgICB9O1xuICBcbiAgICAgIGlmIChcbiAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcbiAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHxcbiAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUocGVvcGxlVmFsaWRhdGFibGUpXG4gICAgICApIHtcbiAgICAgICAgYWxlcnQoXCJJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluIVwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsIGVudGVyZWREZXNjcmlwdGlvbiwgK2VudGVyZWRQZW9wbGVdO1xuICAgICAgfVxuICAgIH1cbiAgXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcbiAgICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XG4gICAgfVxuICBcbiAgICBAQXV0b2JpbmRcbiAgICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gY29uc29sZS5sb2codGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSk7XG4gICAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xuICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VySW5wdXQ7XG4gICAgICAgIGNvbnNvbGUubG9nKHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzYywgcGVvcGxlKTtcbiAgICAgICAgdGhpcy5jbGVhcklucHV0cygpOyAvLyBjbGVhciBmb3JtIG9uY2UgaXQncyBzdWJtaXR0ZWRcbiAgICAgIH1cbiAgICB9XG4gIH1cbiIsImltcG9ydCB7RHJhZ2dhYmxlfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJ1xuaW1wb3J0IHtQcm9qZWN0fSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCdcbmltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9iYXNlLWNvbXBvbmVudCdcbmltcG9ydCB7YXV0b2JpbmR9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnXG5cbi8vIFByb2plY3RJdGVtIENsYXNzXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW1cbiAgICBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PlxuICAgIGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcbiAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XG5cbiAgICBnZXQgcGVyc29ucygpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBcIjEgcGVyc29uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgICAgIHN1cGVyKFwic2luZ2xlLXByb2plY3RcIiwgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZCk7XG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgICAgICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XG4gICAgfVxuICAgIEBhdXRvYmluZFxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJ1xuICAgIH1cbiAgICBkcmFnRW5kSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEcmFnRW5kXCIpO1xuICAgIH1cblxuICAgIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW5kXCIsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgcmVuZGVyQ29udGVudCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoMlwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaDNcIikhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgXCIgYXNzaWduZWRcIjtcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJwXCIpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvbjtcbiAgICAgICAgfVxuICAgIH1cbiIsImltcG9ydCB7RHJhZ1RhcmdldH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCdcbmltcG9ydCB7UHJvamVjdCwgUHJvamVjdFN0YXR1c30gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vYmFzZS1jb21wb25lbnQnXG5pbXBvcnQge2F1dG9iaW5kfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJ1xuaW1wb3J0IHtwcm9qZWN0U3RhdGV9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnXG5pbXBvcnQge1Byb2plY3RJdGVtfSBmcm9tICcuL3Byb2plY3QtaXRlbSdcblxuXG4vLyBQcm9qZWN0TGlzdCBjbGFzc1xuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0XG4gIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD5cbiAgaW1wbGVtZW50cyBEcmFnVGFyZ2V0IHtcbiAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6IFwiYWN0aXZlXCIgfCBcImZpbmlzaGVkXCIpIHtcbiAgICBzdXBlcihcInByb2plY3QtbGlzdFwiLCBcImFwcFwiLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcblxuICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdO1xuXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGlmKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJyl7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKTtcbiAgICAgIGxpc3RFbD8uY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcbiAgICB9XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zdCBwcmpJZCA9IGV2ZW50LmRhdGFUcmFuc2ZlciEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcmpJZCwgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZClcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCkge1xuICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xuICAgIGxpc3RFbD8uY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJylcbiAgfVxuXG4gIGNvbmZpZ3VyZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcilcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKVxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcilcbiAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcbiAgICAgIGNvbnN0IHJlbGV2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByaikgPT4ge1xuICAgICAgICBpZiAodGhpcy50eXBlID09PSBcImFjdGl2ZVwiKSB7XG4gICAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IHJlbGV2YW50UHJvamVjdHM7XG4gICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XG4gICAgfSk7XG4gIH1cbiAgcmVuZGVyQ29udGVudCgpIHtcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhLmlkID0gbGlzdElkO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiaDJcIikhLnRleHRDb250ZW50ID1cbiAgICAgIHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgXCJQUk9KRUNUU1wiOyAvLyBhY3RpdmUgb3IgZmluaXNoZWQsIGNvbnZlcnRlZCB0byBhbGwgY2Fwc1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSE7XG4gICAgbGlzdEVsLmlubmVySFRNTCA9IFwiXCI7XG4gICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xuICAgICAgLy8gICBjb25zdCBsaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICAgIC8vICAgbGlzdEl0ZW0udGV4dENvbnRlbnQgPSBwcmpJdGVtLnRpdGxlO1xuICAgICAgLy8gICBsaXN0RWwuYXBwZW5kQ2hpbGQobGlzdEl0ZW0pO1xuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhLmlkLCBwcmpJdGVtKTtcbiAgICB9XG4gIH1cbn0gICBcbiIsImltcG9ydCB7UHJvamVjdElucHV0fSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCdcbmltcG9ydCB7UHJvamVjdExpc3R9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnXG5cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdChcImFjdGl2ZVwiKTtcbm5ldyBQcm9qZWN0TGlzdChcImZpbmlzaGVkXCIpO1xuXG5cbiJdLCJzb3VyY2VSb290IjoiIn0=